---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "scm_decryption_rule Resource - scm"
subcategory: ""
description: |-
  DecryptionRule resource
---

# scm_decryption_rule (Resource)

DecryptionRule resource

## Example Usage

```terraform
# --- 1. TAG Resource ---
resource "scm_tag" "decryption_position_tag" {
  name   = "decryption-position-tag"
  folder = "All"
  color  = "Purple"
}

# --- 2. ANCHOR DECRYPTION RULE (Used for relative positioning) ---
resource "scm_decryption_rule" "anchor_decryption_rule" {
  name        = "anchor-decryption-rule"
  description = "Base rule for testing 'before' and 'after' positioning."
  folder      = "All"
  position    = "pre" # Decryption Rules typically exist in the 'pre' rulebase
  action      = "decrypt"

  # Core Match Criteria (REQUIRED fields)
  from        = ["trust"]         # Source security zone
  to          = ["untrust"]       # Destination security zone
  source      = ["any"]           # Source addresses
  destination = ["any"]           # Destination addresses
  service     = ["service-https"] # Services (e.g., standard HTTPS port)
  category    = ["high-risk"]     # Destination URL Category
  source_user = ["any"]           # Source user/group
  type = {
    ssl_forward_proxy = {}
  }
  destination_hip = ["any"]

  # Optional fields
  tag                = [scm_tag.decryption_position_tag.name]
  log_success        = true
  log_fail           = true
  disabled           = false
  negate_source      = false
  negate_destination = false
}

# --- 3. ABSOLUTE POSITIONING Examples ("top" and "bottom") ---

resource "scm_decryption_rule" "rule_top_decryption_rule" {
  name        = "top-absolute-decryption-rule"
  description = "Placed at the very TOP of the Decryption rulebase."
  folder      = "All"
  position    = "pre"
  action      = "no-decrypt" # Use no-decrypt for top rules (e.g., skip banking sites)

  # POSITIONING: Sets rule at the absolute beginning of the rulebase
  relative_position = "top"

  # Core Match Criteria
  from        = ["any"]
  to          = ["any"]
  source      = ["any"]
  destination = ["any"]
  service     = ["service-https"]
  category    = ["high-risk"]
  source_user = ["any"]
  type = {
    ssl_forward_proxy = {}
  }
}


resource "scm_decryption_rule" "rule_bottom_decryption_rule" {
  name        = "bottom-absolute-decryption-rule"
  description = "Placed at the very BOTTOM of the Decryption rulebase."
  folder      = "All"
  position    = "pre"
  action      = "decrypt"

  # POSITIONING: Sets rule at the absolute end of the rulebase
  relative_position = "bottom"

  # Core Match Criteria
  from        = ["any"]
  to          = ["any"]
  source      = ["any"]
  destination = ["any"]
  service     = ["service-https"]
  category    = ["high-risk"]
  source_user = ["any"]
  type = {
    ssl_forward_proxy = {}
  }
}

# --- 4. RELATIVE POSITIONING Examples ("before" and "after") ---

resource "scm_decryption_rule" "rule_before_anchor_decryption" {
  name        = "before-anchor-decryption-rule"
  description = "Positioned immediately BEFORE the anchor-decryption-rule. Updating"
  folder      = "All"
  position    = "pre"
  action      = "decrypt"

  # POSITIONING: Requires both relative_position and target_rule
  relative_position = "before"
  target_rule       = scm_decryption_rule.anchor_decryption_rule.id # Reference anchor by its ID

  # Core Match Criteria
  from        = ["trust"]
  to          = ["untrust"]
  source      = ["10.1.1.0/24"] # Specific source subnet
  destination = ["any"]
  service     = ["service-https"]
  category    = ["high-risk"]
  source_user = ["any"]
  type = {
    ssl_forward_proxy = {}
  }
}

resource "scm_decryption_rule" "rule_after_anchor_decryption" {
  name        = "after-anchor-decryption-rule_123"
  description = "Positioned immediately AFTER the anchor-decryption-rule."
  folder      = "All"
  position    = "pre"
  action      = "decrypt"

  # POSITIONING: Requires both relative_position and target_rule
  relative_position = "after"
  target_rule       = scm_decryption_rule.anchor_decryption_rule.id # Reference anchor by its ID

  # Core Match Criteria
  from        = ["any"]
  to          = ["untrust"]
  source      = ["any"]
  destination = ["192.168.1.10"] # Specific destination host
  service     = ["service-https"]
  category    = ["any"]
  source_user = ["any"]
  type = {
    ssl_forward_proxy = {}
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `action` (String) The action to be taken
- `category` (List of String) The destination URL category
- `destination` (List of String) The destination addresses
- `from` (List of String) The source security zone
- `name` (String) The name of the decryption rule
- `service` (List of String) The destination services and/or service groups
- `source` (List of String) The source addresses
- `source_user` (List of String) List of source users and/or groups.  Reserved words include `any`, `pre-login`, `known-user`, and `unknown`.
- `to` (List of String) The destination security zone

### Optional

- `description` (String) The description of the decryption rule
- `destination_hip` (List of String) The Host Integrity Profile of the destination host
- `device` (String) The device in which the resource is defined
> ℹ️ **Note:** You must specify exactly one of `device`, `folder`, and `snippet`.
- `disabled` (Boolean) Is the rule disabled?
- `folder` (String) The folder in which the resource is defined
> ℹ️ **Note:** You must specify exactly one of `device`, `folder`, and `snippet`.
- `log_fail` (Boolean) Log failed decryption events?
- `log_setting` (String) The log settings of the decryption rule
- `log_success` (Boolean) Log successful decryption events?
- `negate_destination` (Boolean) Negate the destination addresses?
- `negate_source` (Boolean) Negate the source addresses?
- `position` (String) The position of a security rule
- `profile` (String) The decryption profile associated with the decryption rule
- `relative_position` (String) Relative positioning rule. String must be one of these: `"before"`, `"after"`, `"top"`, `"bottom"`. If not specified, rule is created at the bottom of the ruleset.
- `snippet` (String) The snippet in which the resource is defined
> ℹ️ **Note:** You must specify exactly one of `device`, `folder`, and `snippet`.
- `source_hip` (List of String) Source hip
- `tag` (List of String) The tags associated with the decryption rule
- `target_rule` (String) The name or UUID of the rule to position this rule relative to. Required when `relative_position` is `"before"` or `"after"`.
- `type` (Attributes) The type of decryption (see [below for nested schema](#nestedatt--type))

### Read-Only

- `id` (String) The UUID of the decryption rule
- `tfid` (String) The Terraform ID.

<a id="nestedatt--type"></a>
### Nested Schema for `type`

Optional:

- `ssl_forward_proxy` (Attributes) Ssl forward proxy
> ℹ️ **Note:** You must specify exactly one of `ssl_forward_proxy` and `ssl_inbound_inspection`. (see [below for nested schema](#nestedatt--type--ssl_forward_proxy))
- `ssl_inbound_inspection` (String) add the certificate name for SSL inbound inspection
> ℹ️ **Note:** You must specify exactly one of `ssl_forward_proxy` and `ssl_inbound_inspection`.

<a id="nestedatt--type--ssl_forward_proxy"></a>
### Nested Schema for `type.ssl_forward_proxy`


## Import

The following command can be used to import a resource not managed by Terraform:

```bash
terraform import scm_decryption_rule.example folder:::id
```

or

```bash
terraform import scm_decryption_rule.example :snippet::id
```

or

```bash
terraform import scm_decryption_rule.example ::device:id
```

**Note:** Please provide just one of folder, snippet, or device for the import command.

