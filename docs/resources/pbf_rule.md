---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "scm_pbf_rule Resource - scm"
subcategory: ""
description: |-
  PbfRule resource
---

# scm_pbf_rule (Resource)

PbfRule resource

## Example Usage

```terraform
resource "scm_tag" "example_tag" {
  folder = "All"
  name   = "pbf-rule-tag-test-1"
  color  = "Red"
}

# --- PBF Rule Resource with discard action---
resource "scm_pbf_rule" "example_pbf_rule" {
  # Required fields
  name   = "pbf-test-rule-discard"
  folder = "All"

  # Optional: Description of the rule
  description = "PBF rule for forwarding specific traffic."

  # The source and destination criteria
  # Assuming 'any' for all except where a value is specified.
  from = {
    zone = ["zone-untrust"] # Traffic coming from the 'zone-untrust' zone
  }
  source      = ["any"]          # Source addresses
  destination = ["any"]          # Destination addresses
  application = ["any"]          # Applications
  service     = ["service-http"] # Services (ports/protocols)
  source_user = ["any"]


  # Define the action for the PBF rule
  action = {
    discard = {}
  }

  # Apply the created tag
  tag = [
    scm_tag.example_tag.name
  ]

  # Optional: Enforce Symmetric Return
  enforce_symmetric_return = {
    enabled = false
    # nexthop_address_list is optional here, leave it out for a simpler example
  }

  schedule = "non-work-hours"
}

# --- PBF Rule Resource with no-pbf action---
resource "scm_pbf_rule" "example_no_pbf_rule" {
  # Required fields
  name   = "pbf-test-rule-no-pbf"
  folder = "All"

  # Optional: Description of the rule
  description = "PBF rule for forwarding specific traffic"

  # The source and destination criteria
  # Assuming 'any' for all except where a value is specified.
  from = {
    zone = ["zone-untrust"] # Traffic coming from the 'zone-untrust' zone
  }
  source      = ["any"]           # Source addresses
  destination = ["any"]           # Destination addresses
  application = ["any"]           # Applications
  service     = ["service-https"] # Services (ports/protocols)
  source_user = ["any"]


  # Define the action for the PBF rule
  action = {
    no_pbf = {}
  }

  # Apply the created tag
  tag = [
    scm_tag.example_tag.name
  ]

  # Optional: Enforce Symmetric Return
  enforce_symmetric_return = {
    enabled = false
  }

  schedule = "non-work-hours"
}

# --- PBF Rule Resource with forward action---
resource "scm_pbf_rule" "example_forward_pbf_rule" {
  # Required fields
  name   = "pbf-test-rule-forward"
  folder = "All"

  # Optional: Description of the rule
  description = "PBF rule for forwarding specific traffic"

  # The source and destination criteria
  # Assuming 'any' for all except where a value is specified.
  from = {
    zone = ["zone-untrust"] # Traffic coming from the 'zone-untrust' zone
  }
  source      = ["any"]          # Source addresses
  destination = ["any"]          # Destination addresses
  application = ["any"]          # Applications
  service     = ["service-http"] # Services (ports/protocols)
  source_user = ["any"]


  # Define the action for the PBF rule
  action = {
    forward = {
      egress_interface = "ethernet1/1" # The egress interface for forwarding
      nexthop = {
        ip_address = "192.168.1.254" # The next hop IP address
      }
      #Optional: Monitor settings
      monitor = {
        ip_address             = "8.8.8.10"
        profile                = "test_tf_profile" #this should exists 
        disable_if_unreachable = true
      }
    }
  }

  # Apply the created tag
  tag = [
    scm_tag.example_tag.name
  ]

  # Optional: Enforce Symmetric Return
  enforce_symmetric_return = {
    enabled = true
  }

  schedule = "non-work-hours"
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Optional

- `action` (Attributes) Action (see [below for nested schema](#nestedatt--action))
- `application` (List of String) Applications
- `description` (String) Description
- `destination` (List of String) Destination addresses
- `device` (String) The device in which the resource is defined

> ℹ️ **Note:** You must specify exactly one of `device`, `folder`, and `snippet`.
- `enforce_symmetric_return` (Attributes) Enforce symmetric return (see [below for nested schema](#nestedatt--enforce_symmetric_return))
- `folder` (String) The folder in which the resource is defined

> ℹ️ **Note:** You must specify exactly one of `device`, `folder`, and `snippet`.
- `from` (Attributes) From (see [below for nested schema](#nestedatt--from))
- `name` (String) PBF rule name
- `schedule` (String) Schedule
- `service` (List of String) Services
- `snippet` (String) The snippet in which the resource is defined

> ℹ️ **Note:** You must specify exactly one of `device`, `folder`, and `snippet`.
- `source` (List of String) Source addresses
- `source_user` (List of String) Source users
- `tag` (List of String) Tags

### Read-Only

- `id` (String) UUID of the resource
- `tfid` (String) The Terraform ID.

<a id="nestedatt--action"></a>
### Nested Schema for `action`

Optional:

- `discard` (Attributes) Discard

> ℹ️ **Note:** You must specify exactly one of `discard`, `forward`, and `no_pbf`. (see [below for nested schema](#nestedatt--action--discard))
- `forward` (Attributes) Forward

> ℹ️ **Note:** You must specify exactly one of `discard`, `forward`, and `no_pbf`. (see [below for nested schema](#nestedatt--action--forward))
- `no_pbf` (Attributes) No pbf

> ℹ️ **Note:** You must specify exactly one of `discard`, `forward`, and `no_pbf`. (see [below for nested schema](#nestedatt--action--no_pbf))

<a id="nestedatt--action--discard"></a>
### Nested Schema for `action.discard`


<a id="nestedatt--action--forward"></a>
### Nested Schema for `action.forward`

Optional:

- `egress_interface` (String) Egress interface
- `monitor` (Attributes) Monitor (see [below for nested schema](#nestedatt--action--forward--monitor))
- `nexthop` (Attributes) Nexthop (see [below for nested schema](#nestedatt--action--forward--nexthop))

<a id="nestedatt--action--forward--monitor"></a>
### Nested Schema for `action.forward.monitor`

Optional:

- `disable_if_unreachable` (Boolean) Disable this rule if nexthop/monitor ip is unreachable?
- `ip_address` (String) Monitor IP address
- `profile` (String) Monitoring profile


<a id="nestedatt--action--forward--nexthop"></a>
### Nested Schema for `action.forward.nexthop`

Optional:

- `fqdn` (String) Next hop FQDN

> ℹ️ **Note:** You must specify exactly one of `fqdn` and `ip_address`.
- `ip_address` (String) Next hop IP address

> ℹ️ **Note:** You must specify exactly one of `fqdn` and `ip_address`.



<a id="nestedatt--action--no_pbf"></a>
### Nested Schema for `action.no_pbf`



<a id="nestedatt--enforce_symmetric_return"></a>
### Nested Schema for `enforce_symmetric_return`

Optional:

- `enabled` (Boolean) Enforce symmetric return?
- `nexthop_address_list` (Attributes List) Next hop IP addresses (see [below for nested schema](#nestedatt--enforce_symmetric_return--nexthop_address_list))

<a id="nestedatt--enforce_symmetric_return--nexthop_address_list"></a>
### Nested Schema for `enforce_symmetric_return.nexthop_address_list`

Optional:

- `name` (String) Next hop IP address



<a id="nestedatt--from"></a>
### Nested Schema for `from`

Optional:

- `interface` (List of String) Source interfaces

> ℹ️ **Note:** You must specify exactly one of `interface` and `zone`.
- `zone` (List of String) Source zones

> ℹ️ **Note:** You must specify exactly one of `interface` and `zone`.


## Import

The following command can be used to import a resource not managed by Terraform:

```bash
terraform import scm_pbf_rule.example folder:::id
```

or

```bash
terraform import scm_pbf_rule.example :snippet::id
```

or

```bash
terraform import scm_pbf_rule.example ::device:id
```

**Note:** Please provide just one of folder, snippet, or device for the import command.

