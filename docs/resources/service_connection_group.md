---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "scm_service_connection_group Resource - scm"
subcategory: ""
description: |-
  ServiceConnectionGroup resource
---

# scm_service_connection_group (Resource)

ServiceConnectionGroup resource

## Example Usage

```terraform
variable "folder_scope" {
  description = "The folder scope for the SCM resource (e.g., 'Shared', 'Predefined', or a specific folder name)."
  type        = string
  default     = "Service Connections"
}

# ------------------------------------------------------------------
# I. VPN COMPONENT RESOURCES (Creation/Management)
# ------------------------------------------------------------------

## 1. Define the IKE Crypto Profile (IKE Phase 1)
# Note: The resource name is plural: "scm_ike_crypto_profile"
resource "scm_ike_crypto_profile" "example" {
  name       = "example-sc-ike-crypto"
  folder     = var.folder_scope
  hash       = ["sha256"]
  dh_group   = ["group14"]
  encryption = ["aes-256-cbc"]
}

## 2. Define the IPsec Crypto Profile (IKE Phase 2)
# Note: The resource name is plural and nested blocks now use an equals sign (=).
resource "scm_ipsec_crypto_profile" "example" {
  name   = "panw-sc-Crypto"
  folder = var.folder_scope

  esp = {
    encryption     = ["aes-256-gcm"]
    authentication = ["sha256"]
  }

  dh_group = "group14"

  lifetime = {
    hours = 8
  }
}

## 3. Define the IKE Gateway
# Note: The resource name is plural and nested blocks now use an equals sign (=).
resource "scm_ike_gateway" "example" {
  name   = "example-sc-gateway"
  folder = var.folder_scope

  peer_address = {
    ip = "1.1.1.1"
  }

  authentication = {
    pre_shared_key = {
      # In a real-world scenario, use a variable marked as sensitive for the key.
      key = "secret"
    }
  }

  protocol = {
    ikev1 = {
      ike_crypto_profile = scm_ike_crypto_profile.example.name
    }
  }
}

## 4. Define the IPsec Tunnel
# Note: Nested 'auto_key' block uses an equals sign (=).
resource "scm_ipsec_tunnel" "example" {
  name                     = "example-sc-tunnel"
  folder                   = var.folder_scope
  tunnel_interface         = "tunnel"
  anti_replay              = true
  copy_tos                 = false
  enable_gre_encapsulation = false

  auto_key = {
    ike_gateway = [{
      name = scm_ike_gateway.example.name
    }]

    ipsec_crypto_profile = scm_ipsec_crypto_profile.example.name
  }

  depends_on = [
    scm_ike_gateway.example
  ]
}

## 5. Service Connection (The target for the group)
resource "scm_service_connection" "site_a_vpn_sc" {
  name         = "creating_a_service_connection_sc_grp"
  region       = "us-west-1a"
  ipsec_tunnel = scm_ipsec_tunnel.example.name
  subnets = [
    "10.1.0.0/16",
    "172.16.0.0/24"
  ]
  source_nat = false
}

## 5. Service Connection (The target for the group)
resource "scm_service_connection" "site_a_vpn_sc_2" {
  name         = "creating_a_service_connection_sc_grp_2"
  region       = "us-west-1a"
  ipsec_tunnel = scm_ipsec_tunnel.example.name
  subnets = [
    "10.1.0.0/16",
    "172.16.0.0/24"
  ]
  source_nat = true
}

# ------------------------------------------------------------------
# II. SERVICE CONNECTION GROUP RESOURCE
# ------------------------------------------------------------------

## 6. Service Connection Group (Groups the Service Connection created above)
resource "scm_service_connection_group" "example_group" {
  name = "service-connection-group-app_sc_grp"
  # The key attribute: references the name of the Service Connection resource
  target = [
    scm_service_connection.site_a_vpn_sc.name, scm_service_connection.site_a_vpn_sc_2.name
  ]

  disable_snat = true
  pbf_only     = false
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Name
- `target` (List of String) Target

### Optional

- `disable_snat` (Boolean) Disable snat
- `pbf_only` (Boolean) Pbf only

### Read-Only

- `folder` (String) The folder in which the resource is defined
- `id` (String) The UUID of the service connection group
- `tfid` (String) The Terraform ID.


## Import

The following command can be used to import a resource not managed by Terraform:

```bash
terraform import scm_service_connection_group.example folder:::id
```

or

```bash
terraform import scm_service_connection_group.example :snippet::id
```

or

```bash
terraform import scm_service_connection_group.example ::device:id
```

**Note:** Please provide just one of folder, snippet, or device for the import command.

