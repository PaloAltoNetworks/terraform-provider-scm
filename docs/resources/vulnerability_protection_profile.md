---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "scm_vulnerability_protection_profile Resource - scm"
subcategory: ""
description: |-
  VulnerabilityProtectionProfile resource
---

# scm_vulnerability_protection_profile (Resource)

VulnerabilityProtectionProfile resource

## Example Usage

```terraform
resource "scm_vulnerability_protection_profile" "scm_vp_profile_1_test" {
  folder      = "Shared"
  name        = "vp-profile-1-test"
  description = "basic profile"
}

resource "scm_vulnerability_protection_profile" "scm_vp_profile_2_test" {
  folder      = "Shared"
  name        = "vp-profile-2-test"
  description = "rules: allow, alert, and drop"

  rules = [
    {
      name = "Rule-Informational-Allow"
      action = {
        allow = {}
      }
      packet_capture = "extended-capture"
      severity       = ["informational"]
      category       = "scan"
      cve            = ["N/A"]
      host           = "client"
      vendor_id      = ["Match Any Vendor"]
      threat_name    = "30000"
    },
    {
      name = "Rule-Medium-Alert"
      action = {
        alert = {}
      }
      packet_capture = "single-packet"
      severity       = ["medium"]
      category       = "info-leak"
      cve            = ["Match Any CVE"]
      host           = "server"
      vendor_id      = ["MS08-037"]
      threat_name    = "OpenSSL Threat"
    },
    {
      name = "Rule-Critical-High-Drop"
      action = {
        drop = {}
      }
      packet_capture = "disable"
      severity       = ["critical", "high"]
      category       = "overflow"
      cve            = ["CVE-2008-1147"]
      host           = "any"
      vendor_id      = ["Match Any Vendor"]
      threat_name    = "any"
    }
  ]
}

resource "scm_vulnerability_protection_profile" "scm_vp_profile_3_test" {
  folder      = "Shared"
  name        = "vp-profile-3-test"
  description = "rules: reset client, reset server, reset both"
  rules = [
    {
      name = "Rule-Low-Reset_Client"
      action = {
        reset_client = {}
      }
      severity    = ["low"]
      category    = "protocol-anomaly"
      cve         = ["CVE-2010-3332", "CVE-2019-14537"]
      host        = "client"
      vendor_id   = ["MSO5-032", "IZ18434"]
      threat_name = "30261"
    },
    {
      name = "Rule-Info-Low-Reset_Server"
      action = {
        reset_server = {}
      }
      packet_capture = "disable"
      severity       = ["informational", "low"]
      category       = "insecure-credentials"
      cve            = ["N/A"]
      host           = "server"
      vendor_id      = ["Match Any Vendor"]
      threat_name    = "Zone Bypass"
    },
    {
      name = "Rule-Medium-Reset_Both"
      action = {
        reset_both = {}
      }
      packet_capture = "single-packet"
      severity       = ["medium"]
      category       = "brute-force"
      cve            = ["CVE-2012-0175", "CVE-2024-6387", "CVE-2017-14473"]
      host           = "any"
      vendor_id      = ["CORE-1009-0227", "SHIRO-550", "AST-2012-008"]
      threat_name    = "any"
    }
  ]
}

resource "scm_vulnerability_protection_profile" "scm_vp_profile_4_test" {
  folder      = "Shared"
  name        = "vp-profile-4-test"
  description = "rules: block ip"

  rules = [
    {
      name = "Rule-High-Critical-Block_IP"
      action = {
        block_ip = {
          duration = 3600
          track_by = "source-and-destination"
        }
      }
      severity    = ["high", "critical"]
      category    = "insecure-credentials"
      cve         = ["N/A"]
      host        = "server"
      vendor_id   = ["Match Any Vendor"]
      threat_name = "Zone Credentials"
    },
    {
      name = "Rule-Low-Medium-Block_IP"
      action = {
        block_ip = {
          duration = 2400
          track_by = "source-and-destination"
        }
      }
      severity    = ["low", "medium"]
      category    = "command-execution"
      cve         = ["N/A"]
      host        = "server"
      vendor_id   = ["Match Any Vendor"]
      threat_name = "any"
    }
  ]
}

resource "scm_vulnerability_protection_profile" "scm_vp_profile_5_test" {
  folder      = "Shared"
  name        = "vp-profile-5-test"
  description = "override"

  threat_exception = [
    {
      name = "12345"
      action = {
        allow = {}
      }
      severity = ["informational"]
      category = "command-execution"
      exempt_ip = [
        { name = "192.14.3.100" },
      ]
      time_attribute = {
        interval  = 3600
        threshold = 24000
        track_by  = "source"
      }
    }
  ]
}

resource "scm_vulnerability_protection_profile" "scm_vp_profile_6_test" {
  folder      = "Shared"
  name        = "vp-profile-6-test"
  description = "mixed"

  rules = [
    {
      name = "Rule-Info-Rest_Both"
      action = {
        allow = {}
      }
      # NOTE: Changed "disabled" to "disable" to match other resources (if "disable" is the correct value)
      packet_capture = "disable"
      severity       = ["informational"]
      category       = "exploit-kit"
      cve            = ["N/A"]
      host           = "client"
      vendor_id      = ["Match Any Vendor"]
      threat_name    = "30000"
    },
    {
      name = "Rule-Low-Alert"
      action = {
        alert = {}
      }
      packet_capture = "single-packet"
      severity       = ["low"]
      category       = "dos"
      cve            = ["CVE-2020-8790"]
      host           = "server"
      vendor_id      = ["MS09-036"]
      threat_name    = "Memory Corruption"
    },
    {
      name = "Rule-Medium-Drop"
      action = {
        drop = {}
      }
      packet_capture = "disable"
      severity       = ["medium", "high"]
      category       = "insecure-credentials"
      cve            = ["N/A"]
      host           = "any"
      vendor_id      = ["Match Any Vendor"]
      threat_name    = "any"
    }
  ]
  threat_exception = [
    {
      name = "12345"
      action = {
        drop = {}
      }
      packet_capture = "single-packet"
      host           = "any"
      category       = "scan"
      cve            = ["CVE-2011-2663", "CVE-2016-9949"]
      exempt_ip = [
        { name = "192.14.3.100" },
      ]
    }
  ]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Name

### Optional

- `description` (String) Description
- `device` (String) The device in which the resource is defined
> ℹ️ **Note:** You must specify exactly one of `device`, `folder`, and `snippet`.
- `folder` (String) The folder in which the resource is defined
> ℹ️ **Note:** You must specify exactly one of `device`, `folder`, and `snippet`.
- `rules` (Attributes List) Rules (see [below for nested schema](#nestedatt--rules))
- `snippet` (String) The snippet in which the resource is defined
> ℹ️ **Note:** You must specify exactly one of `device`, `folder`, and `snippet`.
- `threat_exception` (Attributes List) Threat exception (see [below for nested schema](#nestedatt--threat_exception))

### Read-Only

- `id` (String) UUID of the resource
- `tfid` (String) The Terraform ID.

<a id="nestedatt--rules"></a>
### Nested Schema for `rules`

Optional:

- `action` (Attributes) vulnerability profiles threat exception default action (see [below for nested schema](#nestedatt--rules--action))
- `category` (String) Category
- `cve` (List of String) Cve
- `host` (String) Host
- `name` (String) Name
- `packet_capture` (String) Packet capture
- `severity` (List of String) Severity
- `threat_name` (String) Threat name
- `vendor_id` (List of String) Vendor id

<a id="nestedatt--rules--action"></a>
### Nested Schema for `rules.action`

Optional:

- `alert` (Attributes) Alert
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--rules--action--alert))
- `allow` (Attributes) Allow
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--rules--action--allow))
- `block_ip` (Attributes) vulnerability protection block ip
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--rules--action--block_ip))
- `default` (Attributes) Default
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--rules--action--default))
- `drop` (Attributes) Drop
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--rules--action--drop))
- `reset_both` (Attributes) Reset both
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--rules--action--reset_both))
- `reset_client` (Attributes) Reset client
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--rules--action--reset_client))
- `reset_server` (Attributes) Reset server
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--rules--action--reset_server))

<a id="nestedatt--rules--action--alert"></a>
### Nested Schema for `rules.action.alert`


<a id="nestedatt--rules--action--allow"></a>
### Nested Schema for `rules.action.allow`


<a id="nestedatt--rules--action--block_ip"></a>
### Nested Schema for `rules.action.block_ip`

Optional:

- `duration` (Number) Duration
- `track_by` (String) Track by


<a id="nestedatt--rules--action--default"></a>
### Nested Schema for `rules.action.default`


<a id="nestedatt--rules--action--drop"></a>
### Nested Schema for `rules.action.drop`


<a id="nestedatt--rules--action--reset_both"></a>
### Nested Schema for `rules.action.reset_both`


<a id="nestedatt--rules--action--reset_client"></a>
### Nested Schema for `rules.action.reset_client`


<a id="nestedatt--rules--action--reset_server"></a>
### Nested Schema for `rules.action.reset_server`




<a id="nestedatt--threat_exception"></a>
### Nested Schema for `threat_exception`

Optional:

- `action` (Attributes) vulnerability threat exception default action (see [below for nested schema](#nestedatt--threat_exception--action))
- `exempt_ip` (Attributes List) Exempt ip (see [below for nested schema](#nestedatt--threat_exception--exempt_ip))
- `name` (String) Name
- `notes` (String) Notes
- `packet_capture` (String) Packet capture
- `time_attribute` (Attributes) vulnerability time attribute (see [below for nested schema](#nestedatt--threat_exception--time_attribute))

<a id="nestedatt--threat_exception--action"></a>
### Nested Schema for `threat_exception.action`

Optional:

- `alert` (Attributes) Alert
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--threat_exception--action--alert))
- `allow` (Attributes) Allow
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--threat_exception--action--allow))
- `block_ip` (Attributes) vulnerability protection threat exception block ip
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--threat_exception--action--block_ip))
- `default` (Attributes) Default
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--threat_exception--action--default))
- `drop` (Attributes) Drop
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--threat_exception--action--drop))
- `reset_both` (Attributes) Reset both
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--threat_exception--action--reset_both))
- `reset_client` (Attributes) Reset client
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--threat_exception--action--reset_client))
- `reset_server` (Attributes) Reset server
> ℹ️ **Note:** You must specify exactly one of `alert`, `allow`, `block_ip`, `default`, `drop`, `reset_both`, `reset_client`, and `reset_server`. (see [below for nested schema](#nestedatt--threat_exception--action--reset_server))

<a id="nestedatt--threat_exception--action--alert"></a>
### Nested Schema for `threat_exception.action.alert`


<a id="nestedatt--threat_exception--action--allow"></a>
### Nested Schema for `threat_exception.action.allow`


<a id="nestedatt--threat_exception--action--block_ip"></a>
### Nested Schema for `threat_exception.action.block_ip`

Optional:

- `duration` (Number) Duration
- `track_by` (String) Track by


<a id="nestedatt--threat_exception--action--default"></a>
### Nested Schema for `threat_exception.action.default`


<a id="nestedatt--threat_exception--action--drop"></a>
### Nested Schema for `threat_exception.action.drop`


<a id="nestedatt--threat_exception--action--reset_both"></a>
### Nested Schema for `threat_exception.action.reset_both`


<a id="nestedatt--threat_exception--action--reset_client"></a>
### Nested Schema for `threat_exception.action.reset_client`


<a id="nestedatt--threat_exception--action--reset_server"></a>
### Nested Schema for `threat_exception.action.reset_server`



<a id="nestedatt--threat_exception--exempt_ip"></a>
### Nested Schema for `threat_exception.exempt_ip`

Required:

- `name` (String) Name


<a id="nestedatt--threat_exception--time_attribute"></a>
### Nested Schema for `threat_exception.time_attribute`

Optional:

- `interval` (Number) Interval
- `threshold` (Number) Threshold
- `track_by` (String) Track by


## Import

The following command can be used to import a resource not managed by Terraform:

```bash
terraform import scm_vulnerability_protection_profile.example folder:::id
```

or

```bash
terraform import scm_vulnerability_protection_profile.example :snippet::id
```

or

```bash
terraform import scm_vulnerability_protection_profile.example ::device:id
```

**Note:** Please provide just one of folder, snippet, or device for the import command.

